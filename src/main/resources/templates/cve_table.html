
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>CVE List</title>
</head>
<body>
    <h1>CVE Records</h1>
    <p>Total Records: <span th:text="${totalRecords}"></span></p>
	<form method="get" action="/cves/list">
	    <label for="size">Results Per Page:</label>
	    <select name="size" onchange="this.form.submit()">
	        <option th:value="10" th:selected="${size == 10}">10</option>
	        <option th:value="50" th:selected="${size == 50}">50</option>
	        <option th:value="100" th:selected="${size == 100}">100</option>
	    </select>

	    <!-- Maintain other query params -->
	    <input type="hidden" name="page" th:value="${currentPage}" />
	    <input type="hidden" name="sort" th:value="${sort}" />
	    <input type="hidden" name="dir" th:value="${dir}" />
	</form>

    <table border="1">
        <thead>
            <tr>
                <th>
                    <a th:href="@{/cves/list(sort='id', dir=${reverseDir})}">ID</a>
                </th>
                <th>
                    <a th:href="@{/cves/list(sort='publishedDate', dir=${reverseDir})}">Published Date</a>
                </th>
                <th>
                    <a th:href="@{/cves/list(sort='baseScore', dir=${reverseDir})}">Base Score</a>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="cve : ${paginatedData}">
                <!-- Link to detail page -->
                <td>
                    <a th:href="@{'/cves/' + ${cve.id}}" th:text="${cve.id}"></a>
                </td>
                <td th:text="${cve.publishedDate != null ? cve.publishedDate : 'N/A'}"></td>
                <td th:text="${cve.baseScore != null ? cve.baseScore : 'N/A'}"></td>
            </tr>
        </tbody>
    </table>
	

    <!-- Pagination Controls -->
    <div>
        <button th:if="${currentPage > 0}"
                th:attr="onclick=|window.location='/cves/list?page=${currentPage - 1}&size=${size}&sort=${sort}&dir=${dir}'|">
            Previous
        </button>
        <span>Page <span th:text="${currentPage + 1}"></span> of <span th:text="${totalPages}"></span></span>
        <button th:if="${currentPage + 1 < totalPages}"
                th:attr="onclick=|window.location='/cves/list?page=${currentPage + 1}&size=${size}&sort=${sort}&dir=${dir}'|">
            Next
        </button>
    </div>
</body>
</html>
